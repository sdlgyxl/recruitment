{% extends "base.html" %}
{% import "_macros.html" as macros %}

{% block app_content %}
  <div>
    <div class="col-md-4"><h1>Hi, {{ current_user.name }}</h1></div>
    <div class="col-md-4"></div>
    <div class="col-md-4">
      <form class="form-search" style="margin-top: 20px" method="get" action="{{ url_for('main.user_index') }}">
        {{ form.q(size=20, class='form-control', placeholder=form.q.label.text) }}
      </form>
    </div>
  </div>
  <table class="table table-hover">
    {% for user in users %}
      <tr>
        <td width="5%">
        {% if user.photo %}
          <img src="/static/{{ user.photo }}" style="width: 40px;height:40px;" />
        {% else %}
          <img src="{{ user.avatar(40) }}" style="width: 40px;height:40px;" />
        {%  endif %}
        </td>
        <td width="5%">
          {{ user.id }}
        </td>
        <td width="5%">
          <a href="{{ url_for('main.user_edit', id=user.id, page=request.args.get('page') or 1) }}">{{ user.name }}</a>
        </td>
        <td width="5%">
          {{ user.dept.name }}
        </td>
        <td width="5%">
          {{ user.superior_name.name }}
        </td>
        <td width="5%">
          {{ user.username }}
        </td>
        <td width="5%">
          {{ user.email }}
        </td>
        <td width="5%">
          {{ user.mobile }}
        </td>
        <td width="5%">
          {{ user.manager_state }}
        </td>
        <td width="8%">
          {{ user.birthday.strftime("%Y-%m-%d") }}
        </td>
        <td width="8%">
          {{ user.entrydate.strftime("%Y-%m-%d") }}
        </td>
        <td width="5%">
          {{ user.position }}
        </td>
        <td width="5%">
          {{ user.office }}
        </td>
        <td width="5%">
          {{ user.jobstate }}
        </td>
        <td width="5%">
          {{ user.loginstate }}
        </td>
        <td>
        <a width="5%">
          <a href="/user/edit/{{ user.id }}">编辑</a>
        </td>
      </tr>
    {% endfor %}
  </table>
  <nav aria-label="..." style="text-align: center">
    <div class="pagination">
      {{ macros.pagination_widget(pagination, '.user_index', q) }}
    </div>
  </nav>


{% endblock %}
